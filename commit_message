685cb32 compose reducer on the fly instead of storing reducer array
