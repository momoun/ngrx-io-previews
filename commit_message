595ad896 further changes based on Tim's review
